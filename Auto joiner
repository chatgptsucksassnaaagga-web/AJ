repeat task.wait() until game:IsLoaded()

-- SERVICES
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer

-- CONFIG
local RELAY_URL = "https://visible-self-furnishings-relatives.trycloudflare.com/servers"
local REFRESH_RATE = 8

-- CLEANUP
pcall(function()
    CoreGui:FindFirstChild("KrypthAJ"):Destroy()
end)

-- FONT
local FONT = Font.new("rbxasset://fonts/families/TitilliumWeb.json", Enum.FontWeight.Medium)

-- GUI ROOT
local Gui = Instance.new("ScreenGui")
Gui.Name = "KrypthAJ"
Gui.ResetOnSpawn = false
Gui.IgnoreGuiInset = true
Gui.Parent = CoreGui

-- MAIN FRAME
local Main = Instance.new("Frame")
Main.Size = UDim2.fromScale(0.42, 0.45)
Main.Position = UDim2.fromScale(0.5, 0.5)
Main.AnchorPoint = Vector2.new(0.5, 0.5)
Main.BackgroundColor3 = Color3.fromRGB(15, 17, 22)
Main.BorderSizePixel = 0
Main.Parent = Gui
Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 18)

-- DRAG
do
    local dragging, dragStart, startPos
    Main.InputBegan:Connect(function(i)
        if i.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = i.Position
            startPos = Main.Position
        end
    end)
    UserInputService.InputEnded:Connect(function(i)
        if i.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    UserInputService.InputChanged:Connect(function(i)
        if dragging and i.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = i.Position - dragStart
            Main.Position = startPos + UDim2.fromOffset(delta.X, delta.Y)
        end
    end)
end

-- HEADER
local Header = Instance.new("TextLabel")
Header.Size = UDim2.new(1, -30, 0, 48)
Header.Position = UDim2.fromOffset(15, 10)
Header.Text = "Krypth Auto Joiner"
Header.FontFace = FONT
Header.TextSize = 22
Header.TextXAlignment = Left
Header.TextColor3 = Color3.fromRGB(235,235,240)
Header.BackgroundTransparency = 1
Header.Parent = Main

-- SCROLL
local Scroll = Instance.new("ScrollingFrame")
Scroll.Position = UDim2.fromOffset(15, 65)
Scroll.Size = UDim2.new(1, -30, 1, -80)
Scroll.CanvasSize = UDim2.new()
Scroll.ScrollBarThickness = 4
Scroll.BackgroundTransparency = 1
Scroll.Parent = Main

local Layout = Instance.new("UIListLayout")
Layout.Padding = UDim.new(0, 10)
Layout.Parent = Scroll

Layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    Scroll.CanvasSize = UDim2.fromOffset(0, Layout.AbsoluteContentSize.Y + 20)
end)

-- RAIN
local RainFolder = Instance.new("Folder", Gui)
RunService.RenderStepped:Connect(function()
    if math.random() < 0.3 then
        local drop = Instance.new("Frame")
        drop.Size = UDim2.fromOffset(1, math.random(10,20))
        drop.Position = UDim2.fromScale(math.random(), -0.1)
        drop.BackgroundColor3 = Color3.fromRGB(120,120,140)
        drop.BackgroundTransparency = 0.7
        drop.Parent = RainFolder

        TweenService:Create(drop, TweenInfo.new(1.2), {
            Position = UDim2.fromScale(drop.Position.X.Scale, 1.2),
            BackgroundTransparency = 1
        }):Play()

        task.delay(1.2, function() drop:Destroy() end)
    end
end)

-- ROW CREATOR
local function createRow(brainrot, money, jobId, placeId)
    local Row = Instance.new("Frame")
    Row.Size = UDim2.new(1, 0, 0, 64)
    Row.BackgroundColor3 = Color3.fromRGB(22, 25, 32)
    Row.BorderSizePixel = 0
    Row.Parent = Scroll
    Instance.new("UICorner", Row).CornerRadius = UDim.new(0, 14)

    local Name = Instance.new("TextLabel")
    Name.Position = UDim2.fromOffset(16, 8)
    Name.Size = UDim2.new(0.6, 0, 0, 22)
    Name.Text = brainrot
    Name.FontFace = FONT
    Name.TextSize = 16
    Name.TextXAlignment = Left
    Name.TextColor3 = Color3.fromRGB(230,230,235)
    Name.BackgroundTransparency = 1
    Name.Parent = Row

    local Money = Instance.new("TextLabel")
    Money.Position = UDim2.fromOffset(16, 32)
    Money.Size = UDim2.new(0.6, 0, 0, 18)
    Money.Text = money
    Money.FontFace = FONT
    Money.TextSize = 14
    Money.TextXAlignment = Left
    Money.TextColor3 = Color3.fromRGB(150,200,255)
    Money.BackgroundTransparency = 1
    Money.Parent = Row

    local Join = Instance.new("TextButton")
    Join.Size = UDim2.fromOffset(110, 36)
    Join.Position = UDim2.new(1, -126, 0.5, -18)
    Join.Text = "JOIN"
    Join.FontFace = FONT
    Join.TextSize = 14
    Join.TextColor3 = Color3.fromRGB(20,20,25)
    Join.BackgroundColor3 = Color3.fromRGB(90,200,140)
    Join.BorderSizePixel = 0
    Join.Parent = Row
    Instance.new("UICorner", Join).CornerRadius = UDim.new(0, 12)

    Join.MouseButton1Click:Connect(function()
        TeleportService:TeleportToPlaceInstance(placeId, jobId, LocalPlayer)
    end)
end

-- REFRESH
local function refresh()
    for _,v in ipairs(Scroll:GetChildren()) do
        if v:IsA("Frame") then v:Destroy() end
    end

    local raw = game:HttpGet(RELAY_URL)
    local data = HttpService:JSONDecode(raw)

    for _,entry in ipairs(data) do
        if entry.brainrot and entry.money then
            createRow(entry.brainrot, entry.money, entry.jobId, entry.placeId)
        end
    end
end

-- LOOP
task.spawn(function()
    while true do
        pcall(refresh)
        task.wait(REFRESH_RATE)
    end
end)
