--// ================================
--// Krypth Brainrot Auto Logger + GUI
--// FULL FIXED VERSION
--// ================================

repeat task.wait() until game:IsLoaded()

--// SERVICES
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local CoreGui = game:GetService("CoreGui")

local LocalPlayer = Players.LocalPlayer
local PLACE_ID = game.PlaceId

--// CLEAN OLD GUI
pcall(function()
    local old = CoreGui:FindFirstChild("Krypth AutoJoiner")
    if old then old:Destroy() end
end)

--// ================================
--// HELPERS
--// ================================

local function formatMoney(n)
    n = math.floor(n)
    local s = tostring(n)
    s = s:reverse():gsub("(%d%d%d)", "%1,"):reverse()
    if s:sub(1,1) == "," then s = s:sub(2) end
    return "$"..s.."/s"
end

local function parseMPS(text)
    if not text then return 0 end
    text = tostring(text)
    local num = tonumber(text:match("[%d%.]+")) or 0
    if text:find("K") then num *= 1e3 end
    if text:find("M") then num *= 1e6 end
    if text:find("B") then num *= 1e9 end
    return num
end

--// ================================
--// BRAINROT SCANNER
--// ================================

local function getBrainrots()
    local results = {}
    local seen = {}

    local plots = workspace:FindFirstChild("Plots")
    if not plots then return results end

    for _, plot in ipairs(plots:GetChildren()) do
        for _, obj in ipairs(plot:GetDescendants()) do
            if obj.Name == "AnimalOverhead" then
                local root = obj.Parent
                if root and not seen[root] then
                    seen[root] = true

                    local nameObj = obj:FindFirstChild("DisplayName")
                    local genObj = obj:FindFirstChild("Generation")

                    local name = nameObj and (nameObj.Text or nameObj.Value) or "Unknown"
                    local genText = genObj and (genObj.Text or genObj.Value) or "0"

                    local mps = parseMPS(genText)

                    table.insert(results, {
                        Name = name,
                        MPS = mps
                    })
                end
            end
        end
    end

    table.sort(results, function(a,b)
        return a.MPS > b.MPS
    end)

    return results
end

--// ================================
--// GUI
--// ================================

local function doTween(obj, props, time)
    TweenService:Create(
        obj,
        TweenInfo.new(time or 0.35, Enum.EasingStyle.Quint, Enum.EasingDirection.Out),
        props
    ):Play()
end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "Krypth AutoJoiner"
ScreenGui.IgnoreGuiInset = true
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = CoreGui

local Shadow = Instance.new("ImageLabel")
Shadow.AnchorPoint = Vector2.new(0.5,0.5)
Shadow.Position = UDim2.fromScale(0.5,0.5)
Shadow.Size = UDim2.fromScale(0.5,0.65)
Shadow.Image = "rbxassetid://1316045217"
Shadow.ImageTransparency = 0.45
Shadow.ScaleType = Enum.ScaleType.Slice
Shadow.SliceCenter = Rect.new(10,10,118,118)
Shadow.BackgroundTransparency = 1
Shadow.Parent = ScreenGui

local Main = Instance.new("Frame")
Main.AnchorPoint = Vector2.new(0.5,0.5)
Main.Position = UDim2.fromScale(0.5,0.5)
Main.Size = UDim2.fromScale(0.46,0.6)
Main.BackgroundColor3 = Color3.fromRGB(17,17,22)
Main.BorderSizePixel = 0
Main.ClipsDescendants = true
Main.Parent = ScreenGui
Instance.new("UICorner",Main).CornerRadius = UDim.new(0,20)

local Header = Instance.new("Frame")
Header.Size = UDim2.new(1,0,0,72)
Header.BackgroundTransparency = 1
Header.Parent = Main

local Title = Instance.new("TextLabel")
Title.Position = UDim2.new(0,22,0,0)
Title.Size = UDim2.new(1,-120,1,0)
Title.Text = "ðŸ§  Krypth Brainrot Logger"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 23
Title.TextColor3 = Color3.fromRGB(235,235,245)
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.BackgroundTransparency = 1
Title.Parent = Header

local MinBtn = Instance.new("TextButton")
MinBtn.Size = UDim2.new(0,38,0,38)
MinBtn.Position = UDim2.new(1,-54,0.5,-19)
MinBtn.Text = "â€”"
MinBtn.Font = Enum.Font.GothamBold
MinBtn.TextSize = 22
MinBtn.TextColor3 = Color3.fromRGB(235,235,245)
MinBtn.BackgroundColor3 = Color3.fromRGB(30,30,38)
MinBtn.BorderSizePixel = 0
MinBtn.Parent = Header
Instance.new("UICorner",MinBtn).CornerRadius = UDim.new(0,12)

local Scroll = Instance.new("ScrollingFrame")
Scroll.Position = UDim2.new(0,18,0,90)
Scroll.Size = UDim2.new(1,-36,1,-110)
Scroll.CanvasSize = UDim2.new(0,0,0,0)
Scroll.ScrollBarThickness = 6
Scroll.BackgroundTransparency = 1
Scroll.BorderSizePixel = 0
Scroll.Parent = Main

local Layout = Instance.new("UIListLayout")
Layout.Padding = UDim.new(0,14)
Layout.Parent = Scroll

Layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    Scroll.CanvasSize = UDim2.new(0,0,0,Layout.AbsoluteContentSize.Y + 20)
end)

--// ================================
--// ROW HANDLING
--// ================================

local function clearRows()
    for _,v in ipairs(Scroll:GetChildren()) do
        if v:IsA("Frame") then
            v:Destroy()
        end
    end
end

local function createRow(brainrot, index)
    local Row = Instance.new("Frame")
    Row.Size = UDim2.new(1,0,0,70)
    Row.BackgroundColor3 = index == 1 and Color3.fromRGB(40,35,20) or Color3.fromRGB(23,23,30)
    Row.BorderSizePixel = 0
    Row.Parent = Scroll
    Instance.new("UICorner",Row).CornerRadius = UDim.new(0,16)

    local Text = Instance.new("TextLabel")
    Text.Position = UDim2.new(0,22,0,0)
    Text.Size = UDim2.new(0.7,-22,1,0)
    Text.Text = (index == 1 and "ðŸ‘‘ " or "") .. brainrot.Name .. "  â€¢  " .. formatMoney(brainrot.MPS)
    Text.Font = Enum.Font.Gotham
    Text.TextSize = 16
    Text.TextColor3 = Color3.fromRGB(220,220,230)
    Text.TextXAlignment = Enum.TextXAlignment.Left
    Text.BackgroundTransparency = 1
    Text.Parent = Row

    local Join = Instance.new("TextButton")
    Join.Size = UDim2.new(0,130,0,42)
    Join.Position = UDim2.new(1,-150,0.5,-21)
    Join.Text = "JOIN"
    Join.Font = Enum.Font.GothamBold
    Join.TextSize = 15
    Join.TextColor3 = Color3.fromRGB(18,18,22)
    Join.BackgroundColor3 = Color3.fromRGB(45,200,125)
    Join.BorderSizePixel = 0
    Join.Parent = Row
    Instance.new("UICorner",Join).CornerRadius = UDim.new(0,12)

    Join.MouseButton1Click:Connect(function()
        TeleportService:Teleport(PLACE_ID, LocalPlayer)
    end)
end

--// ================================
--// UPDATE LOOP
--// ================================

task.spawn(function()
    while true do
        task.wait(5)

        local brainrots = getBrainrots()
        clearRows()

        for i = 1, math.min(#brainrots, 15) do
            createRow(brainrots[i], i)
        end
    end
end)

--// ================================
--// MINIMIZE
--// ================================

local minimized = false
local fullSize = Main.Size

MinBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    if minimized then
        doTween(Main, {Size = UDim2.new(fullSize.X.Scale,0,0,72)},0.35)
        doTween(Shadow, {Size = UDim2.new(0.5,0,0,90)},0.35)
        Scroll.Visible = false
    else
        doTween(Main, {Size = fullSize},0.4)
        doTween(Shadow, {Size = UDim2.fromScale(0.5,0.65)},0.4)
        Scroll.Visible = true
    end
end)
