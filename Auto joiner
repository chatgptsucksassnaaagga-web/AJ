repeat task.wait() until game:IsLoaded()

--// Services
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer

--// CONFIG
local RELAY_SERVERS_URL = "https://visible-self-furnishings-relatives.trycloudflare.com/servers"
local REFRESH_INTERVAL = 5

--// Cleanup old GUI
pcall(function()
    local old = CoreGui:FindFirstChild("Krypth AJ")
    if old then old:Destroy() end
end)

--// Helpers
local function formatNumber(n)
    n = tonumber(n) or 0
    local s = tostring(math.floor(n))
    return s:reverse():gsub("(%d%d%d)", "%1,"):reverse():gsub("^,", "")
end

--// GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "Krypth AJ"
ScreenGui.IgnoreGuiInset = true
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = CoreGui

--// Rain Layer
local RainLayer = Instance.new("Frame")
RainLayer.Size = UDim2.fromScale(1,1)
RainLayer.BackgroundTransparency = 1
RainLayer.ZIndex = 1
RainLayer.Parent = ScreenGui

-- Rain effect
task.spawn(function()
    while ScreenGui.Parent do
        local drop = Instance.new("Frame")
        drop.Size = UDim2.new(0,2,0,math.random(14,22))
        drop.Position = UDim2.fromScale(math.random(), -0.1)
        drop.BackgroundColor3 = Color3.fromRGB(120,120,140)
        drop.BackgroundTransparency = 0.3
        drop.BorderSizePixel = 0
        drop.ZIndex = 2
        drop.Parent = RainLayer

        TweenService:Create(
            drop,
            TweenInfo.new(math.random(30,50)/60, Enum.EasingStyle.Linear),
            {Position = UDim2.fromScale(drop.Position.X.Scale,1.1)}
        ):Play()

        task.delay(1, function()
            if drop then drop:Destroy() end
        end)

        task.wait(0.04)
    end
end)

--// Main Frame
local Main = Instance.new("Frame")
Main.AnchorPoint = Vector2.new(0.5,0.5)
Main.Position = UDim2.fromScale(0.5,0.5)
Main.Size = UDim2.fromScale(0.42,0.6)
Main.BackgroundColor3 = Color3.fromRGB(15,16,22)
Main.BorderSizePixel = 0
Main.ZIndex = 10
Main.Parent = ScreenGui
Instance.new("UICorner", Main).CornerRadius = UDim.new(0,20)

--// Header
local Header = Instance.new("TextLabel")
Header.Size = UDim2.new(1,0,0,70)
Header.Text = "ðŸ§  Krypth AJ"
Header.FontFace = Font.new("rbxasset://fonts/families/TitilliumWeb.json", Enum.FontWeight.Bold)
Header.TextSize = 28
Header.TextColor3 = Color3.fromRGB(240,240,255)
Header.BackgroundTransparency = 1
Header.ZIndex = 11
Header.Parent = Main

--// Scroll
local Scroll = Instance.new("ScrollingFrame")
Scroll.Position = UDim2.new(0,20,0,90)
Scroll.Size = UDim2.new(1,-40,1,-120)
Scroll.CanvasSize = UDim2.new()
Scroll.ScrollBarThickness = 6
Scroll.BackgroundTransparency = 1
Scroll.ZIndex = 11
Scroll.Parent = Main

local Layout = Instance.new("UIListLayout")
Layout.Padding = UDim.new(0,14)
Layout.Parent = Scroll

Layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    Scroll.CanvasSize = UDim2.new(0,0,0,Layout.AbsoluteContentSize.Y + 20)
end)

--// Row creator
local function createRow(brainrot, money, jobId)
    local Row = Instance.new("Frame")
    Row.Size = UDim2.new(1,0,0,72)
    Row.BackgroundColor3 = Color3.fromRGB(22,23,30)
    Row.BorderSizePixel = 0
    Row.ZIndex = 12
    Row.Parent = Scroll
    Instance.new("UICorner", Row).CornerRadius = UDim.new(0,14)

    local Text = Instance.new("TextLabel")
    Text.Position = UDim2.new(0,18,0,0)
    Text.Size = UDim2.new(0.65,-18,1,0)
    Text.Text = brainrot .. " â€” " .. money
    Text.FontFace = Font.new("rbxasset://fonts/families/TitilliumWeb.json")
    Text.TextSize = 15
    Text.TextColor3 = Color3.fromRGB(220,220,235)
    Text.TextXAlignment = Enum.TextXAlignment.Left
    Text.BackgroundTransparency = 1
    Text.ZIndex = 13
    Text.Parent = Row

    local Join = Instance.new("TextButton")
    Join.Size = UDim2.new(0,120,0,40)
    Join.Position = UDim2.new(1,-140,0.5,-20)
    Join.Text = "JOIN"
    Join.FontFace = Font.new("rbxasset://fonts/families/TitilliumWeb.json", Enum.FontWeight.Bold)
    Join.TextSize = 14
    Join.TextColor3 = Color3.fromRGB(20,20,25)
    Join.BackgroundColor3 = Color3.fromRGB(80,220,140)
    Join.BorderSizePixel = 0
    Join.ZIndex = 13
    Join.Parent = Row
    Instance.new("UICorner", Join).CornerRadius = UDim.new(0,12)

    Join.MouseButton1Click:Connect(function()
        TeleportService:TeleportToPlaceInstance(game.PlaceId, jobId, LocalPlayer)
    end)

    Row.BackgroundTransparency = 1
    TweenService:Create(Row, TweenInfo.new(0.35, Enum.EasingStyle.Quint), {BackgroundTransparency = 0}):Play()
end

--// Clear rows
local function clearRows()
    for _,v in ipairs(Scroll:GetChildren()) do
        if v:IsA("Frame") then
            v:Destroy()
        end
    end
end

--// Refresh
local function refresh()
    local ok, res = pcall(function()
        return game:HttpGet(RELAY_SERVERS_URL)
    end)
    if not ok then return end

    local data = HttpService:JSONDecode(res)
    if type(data) ~= "table" then return end

    clearRows()

    for _,entry in ipairs(data) do
        if entry.brainrot and entry.money and entry.jobId then
            createRow(entry.brainrot, entry.money, entry.jobId)
        end
    end
end

--// Auto refresh loop
task.spawn(function()
    while true do
        refresh()
        task.wait(REFRESH_INTERVAL)
    end
end)
